---
title: 이미지 프롬프팅 챌린지
date: 2025-06-11 21:20:00 +09:00
categories: [사이드프로젝트, LLM CNN, ]
tags: 
  [
    사이드프로젝트, CNN
  ]
---
## 동기
- 작년 2024 파이콘에서 프롬프트를 잘 적어서 목표 이미지와 가장 유사하게 만드는 사람에게 상품을 주는 행사가 있었다. 이걸 보고 꼭 우리 학교에서도 해보고 싶었는데 마침 또 세특 주제가 CNN 모델이라 이미지의 유사도를 계산하는 차원에서 한번 만들어봤다.
- 사실 이미지의 유사도를 계산하는건 고작 1줄이고, 나머지는 다 UI다...

## 구상
- 일단 기본적인 프로세스는 사용자가 이미지 입력 -> 이미지 생성 -> 이미지의 유사도를 계산 -> 리더보드 업데이트이다. 
- 여기서 가장 생기부 상에서 가장 중요한건 이미지의 유사도를 계산하는 과정이고, CNN, 즉 가중치 행렬을 활용해 합성곱 연산과 풀링하는 과정이 있어야했다. 
- 그리고 UI는 귀찮아서(물론 배포도 간단하니까) streamlit으로 했다. streamlit은 현대적 UI 같은걸 굉장히 잘 만들어준다. 

## 이미지 생성 과정에서의 문제는...
- 이제 처음부터 과정을 설명하면 일단 이미지를 입력받는 부분은 쉬웠다. GPT가 요즘 잘 발전했다고 느끼는게 거의 모든 앱의 대부분을 짜주고 내가 고칠건 별로 없었다. 
- 그 다음에 마주친 문제는 이미지 생성이다. 이미지 생성은 그냥 AI 모델을 쓰기로 했는데, 제일 먼저 찾아본건 openai인데 openai는 free tier에서는 api로 사진 생성 기능을 제공하지 않는단다...그러면 gpt 결제하는 계정에서 무료 크레딧을 받으려고 했는데 무료 크래딧을 이제 안준단다!!!
- 그래서 쓸려는게 재미나이였다. 재미나이의 이미지 생성 모델도 역시 결제해야한다. 다만 제미나이는 무료 크래딧을 빵빵하게 준다.
- 하지만...아직도 이해가 잘 안되는데 제미나이는 만 18세 미만은 api을 못쓴다...(이게 말이 되나)
- 해결법 : 그렇다면 방법은 gpt을 결제하고, 크래딧도 결제하는 것이다. 역시 돈이 많이 깨졌다.

## 알트먼은 GPU가 녹는다지만...
- 나는 지갑이 녹는다. Openai의 Dall-e-3 모델은 한번에 0.2달러 정도가 든다. Dall-e-2는 성능이 굉장히 안좋지만... 내 지갑과 타협하기로 했다.
- 대신 비슷하게 만들어야하는 타겟 사진은 Dall-e-3 모델로 해서 이미지가 이쁘다 ㅎㅎ. 아래 사진이 타겟 이미지이다. 
- ![타겟이미지](/assets/img/post/target_image.png)

## 이미지의 유사도 계산
- 이미지의 유사도 계산은 처음에는 그냥 색상 히스토그램, 윤곽선 일치도 이런걸 볼려다가 그냥 CNN 모델에서 신경망 부분을 빼고 합성곱 층, 풀링 층만 사용했다.
- 그니까 예를 들어서 잘학습된 CNN 기반 분류 모델에서 제일 뒤에 신경망 층을 빼고 이미지를 벡터로만 바꿔주는 그 부분을 사용한 것이다.
- 이렇게 되면 두 벡터가 나오고 이 두 벡터의 코사인 유사도를 구해 유사한 정도를 수치로 나타낼 수 있다. 

## 문제점
- 하지만 역시 가장 큰 문제는 서버에 있다. 내 서버가 이 많은 연산을 감당하기 어려워한다. 심지어 유사도 계산은 GPU 연산인데...이걸 버티기 쉽지 않다.
- 그래서 한 30명 데리고 하면 5분이면 꺼진다...

## 결과
- 생각보다 별거 아닌데 도전의식이 자극되서 다들 열심히 했다. 신기하네 이렇게까지 반응이 좋다고?
- 진짜 서버가 좋으면 계속 운영할텐데...아쉽다

## 소감
- 진짜 항상 보면 서버 문제인거 같다. AWS는 겁나 비싼데...비싼데 기능은 다 제공하니까 다음에는 AWS을 배워봐야겠다
- 아무리 생각해봐도 이게 고급수학 세특에 들어가면 조금 사고긴하다 고민 해봐야겠다...모르겠다...


![실행이미지](/assets/img/post/success.png)