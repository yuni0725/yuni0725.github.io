---
title: (Side Project) 이미지를 엑셀로 바꾸기
date: 2025-06-03 11:20:01 +09:00
categories: [사이드프로젝트, LLM]
tags: 
  [
    사이드프로젝트, LLM
  ]
---
## 문제의 원인
- 갑자기 학교에서 어떤 선생님이 자기가 이미지를 엑셀로 바꾸고 싶은데 잘 안된다고 하셨다. 난 그래서 'GPT한테 사진을 주면 될텐데요??' 라고 했는데 그 분이 자꾸 안된다고 하셔서 사진을 봤더니 내가 여태까지 본 사진들 중에 가장 세로로 가장 긴 사진이였다. 확실히 그걸 보고 GPT한테 시키기는 무리겠구나 생각했다.
- 대충 아래 사진을 39개 붙여놓은 아주 긴 사진이였다. 
  !['이미지'](/assets/img/post/content_1.png)

## 해결방안들
- 그래서 이 이미지를 엑셀로 바꾸기 위해 여러 방안들을 생각해봤다. 
- #### 기존의 툴 이용
  솔직히 이와 같은 고민을 한 사람들이 분명 있을거 같아서 이미지를 엑셀로 바꿔주는 사이트를 찾아봤다. 하지만 두가지 정도 문제점이 있었다.
   1. 먼저 이미지를 잘라야하는데 일반적으로 모두 등간격으로 잘라주는 웹사이트가 많았다. 이는 내 데이터에는 적합하지 않은게 우리 데이터는 등간격으로 자를 수가 없다
   2. 또 다른 문제는 우리 데이터는 한글이 많은데 아직 한글 OCR은 안정확하다. 
  
- #### [`Table-transformers`](https://github.com/microsoft/table-transformer)
  이건 보면서 상당히 신기했는데 table 구조의 표 형태를 transformer 기술 기반으로 인식해주는 기술이 나왔다고 한다. 
  그래서 이걸 써보려다가 알고보니 여기 데이터셋은 논문에 자주 사용되는 데이터란다. 솔직히 fine-tuning도 조금 고민하긴했는데 데이터셋 수집이랑 GPU 문제 때문에 이것도 포기했다. 

## 결론
- 결국 원점이길래 생각해낸 것은 이미지의 특징을 살려서 생각하는 것이다. GPT는 이미지 인식을 잘한다. 하지만 우리 데이터를 인식하지 못하는 이유는 이 이미지가 굉장히 길기 때문이다. 그렇기에 이 이미지를 잘라서 각각 넣으면 분명 잘 동작할 것이다.
- 그러면 이미지는 어떻게 자를까? 이걸 꽤 오래동안 고민해봤는데 우리 데이터는 대학별로 주황색 칸이 있다. 만약에 주황색 칸을 인식해서 그것을 기준으로 자른다면? 대학별로 긴 이미지를 자를 수 있다.
- 그리하여 총 39개의 이미지가 생겼는데 이 이미지를 GPT한테 입력하여서 결국 최종 표를 완성했다. 

## 단점
- 문제는 이 이미지 밖에 처리를 못한다
- 원래 직장이나 사회생활에서 뭘 잘한다고 하면 안되는데...이제 난 다른 사진들도 전처리하게 생겼다 ㅎㅎ
